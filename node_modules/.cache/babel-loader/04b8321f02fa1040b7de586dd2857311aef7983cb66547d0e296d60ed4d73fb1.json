{"ast":null,"code":"var _jsxFileName = \"/home/ewangclarks/Documents/Projects/Technical Interview/hk-sar-react/src/components/checkin/context/CheckInContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport axiosApi from \"../config/axios.client\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CheckInContext = /*#__PURE__*/React.createContext(null);\nexport const CheckInProvider = props => {\n  _s();\n  const [error, setError] = React.useState(false);\n  const [success, setSuccess] = React.useState(false);\n  const [loading, setLoading] = useState(false);\n  const [alert, setAlert] = React.useState('');\n  const [toggleSignIn, setToggleSignIn] = useState(true);\n  const navigate = useNavigate();\n  const location = useLocation();\n  const switchCheckIn = value => {\n    setError(false);\n    setSuccess(false);\n    setToggleSignIn(value);\n  };\n  const login = async user => {\n    var _location$state, _location$state$from;\n    let from = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : (_location$state$from = _location$state.from) === null || _location$state$from === void 0 ? void 0 : _location$state$from.pathname) || '/home';\n    setLoading(true);\n    try {\n      const resp = await axiosApi({\n        'method': 'POST',\n        'url': \"api/public/login\",\n        data: user\n      });\n      const auth = await resp.data;\n      localStorage.setItem('token', 'Bearer ' + auth.accessToken);\n      localStorage.setItem('expiresIn', auth.expiresIn);\n      localStorage.setItem('user', JSON.stringify(auth.userDetails));\n      setLoading(false);\n      window.location.href = \"/\";\n    } catch (error) {\n      setAlert(\"Invalid credentials\");\n      setError(true);\n      setLoading(false);\n    }\n  };\n  const register = async user => {\n    setLoading(true);\n    try {\n      await axiosApi({\n        'method': 'POST',\n        'url': \"api/public/register\",\n        data: user\n      });\n      setLoading(false);\n      setAlert(\"Your account was created successfully\");\n      setSuccess(true);\n      setToggleSignIn(true);\n    } catch (err) {\n      setLoading(false);\n      setAlert(\"Failed to create account!Please try again later\");\n      setError(true);\n    }\n  };\n  const resetAlert = () => {\n    setAlert('');\n    setSuccess(false);\n    setError(false);\n  };\n  const checkIn = {\n    error,\n    success,\n    alert,\n    toggleSignIn,\n    switchCheckIn,\n    login,\n    register,\n    resetAlert,\n    loading\n  };\n  return /*#__PURE__*/_jsxDEV(CheckInContext.Provider, {\n    value: checkIn,\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 9\n  }, this);\n};\n_s(CheckInProvider, \"Em4UKHSs47dgLWZTAg/D7tzCaHA=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = CheckInProvider;\nexport const useCheckInProps = () => {\n  _s2();\n  return React.useContext(CheckInContext);\n};\n_s2(useCheckInProps, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"CheckInProvider\");","map":{"version":3,"names":["React","useState","axiosApi","useLocation","useNavigate","jsxDEV","_jsxDEV","CheckInContext","createContext","CheckInProvider","props","_s","error","setError","success","setSuccess","loading","setLoading","alert","setAlert","toggleSignIn","setToggleSignIn","navigate","location","switchCheckIn","value","login","user","_location$state","_location$state$from","from","state","pathname","resp","data","auth","localStorage","setItem","accessToken","expiresIn","JSON","stringify","userDetails","window","href","register","err","resetAlert","checkIn","Provider","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","useCheckInProps","_s2","useContext","$RefreshReg$"],"sources":["/home/ewangclarks/Documents/Projects/Technical Interview/hk-sar-react/src/components/checkin/context/CheckInContext.js"],"sourcesContent":["import React, {useState} from \"react\";\nimport axiosApi from \"../config/axios.client\";\nimport {useLocation, useNavigate} from \"react-router-dom\";\n\nconst CheckInContext = React.createContext(null);\n\nexport const CheckInProvider = (props) => {\n\n    const [error, setError] = React.useState(false);\n    const [success, setSuccess] = React.useState(false);\n    const [loading, setLoading] = useState(false);\n    const [alert, setAlert] = React.useState('');\n    const [toggleSignIn, setToggleSignIn] = useState(true);\n\n    const navigate = useNavigate();\n    const location = useLocation();\n\n\n    const switchCheckIn = (value) => {\n        setError(false);\n        setSuccess(false);\n        setToggleSignIn(value);\n    }\n\n    const login = async (user) => {\n        let from = location.state?.from?.pathname || '/home';\n        setLoading(true);\n        try {\n            const resp = await axiosApi({'method': 'POST', 'url': \"api/public/login\", data: user});\n            const auth = await resp.data;\n            localStorage.setItem('token', 'Bearer ' + auth.accessToken);\n            localStorage.setItem('expiresIn', auth.expiresIn);\n            localStorage.setItem('user', JSON.stringify(auth.userDetails));\n            setLoading(false);\n           window.location.href=\"/\";\n        } catch (error) {\n            setAlert(\"Invalid credentials\");\n            setError(true);\n            setLoading(false);\n        }\n    }\n\n    const register = async (user) => {\n        setLoading(true);\n        try {\n            await axiosApi({'method': 'POST', 'url': \"api/public/register\", data: user});\n            setLoading(false);\n            setAlert(\"Your account was created successfully\");\n            setSuccess(true);\n            setToggleSignIn(true);\n        } catch (err) {\n            setLoading(false);\n            setAlert(\"Failed to create account!Please try again later\");\n            setError(true);\n        }\n\n    }\n\n    const resetAlert = () => {\n        setAlert('');\n        setSuccess(false);\n        setError(false);\n    }\n\n\n    const checkIn = {error, success, alert, toggleSignIn, switchCheckIn, login, register, resetAlert, loading}\n    return (\n        <CheckInContext.Provider value={checkIn}>\n            {props.children}\n        </CheckInContext.Provider>\n    );\n}\n\n\nexport const useCheckInProps = () => {\n    return React.useContext(CheckInContext);\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}